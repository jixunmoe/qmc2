name: mingw64 build

on: [push]

jobs:
  QMC2-WASM:
    runs-on: ubuntu-latest
    steps:
      - name: 🛎️ Checkout
        uses: actions/checkout@v2.3.1
        with:
          submodules: recursive

      - name: 📦 Install dependencies
        run: |
          sudo apt-get install -y \
            build-essential \
            cmake \
            {gcc,g++}-mingw-w64-i686 \
            {gcc,g++}-mingw-w64-x86-64

      - name: 🔧 Produce WASM build
        run: |
          bash build.sh \
            win_i686    \
            win_x86_64  \
            linux_x64

      - name: 🚀 Publish
        uses: actions/upload-artifact@v2
        with:
          name: binaries
          path: build/bin
